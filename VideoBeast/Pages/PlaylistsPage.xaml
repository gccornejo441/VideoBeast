<Page
    x:Class="VideoBeast.Pages.PlaylistsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:playlists="using:VideoBeast.Playlists"
    mc:Ignorable="d">

	<Page.Resources>
		<Style x:Key="PlaylistListViewItemStyle" TargetType="ListViewItem">
			<Setter Property="Padding" Value="0" />
			<Setter Property="Margin" Value="0,2" />
			<Setter Property="HorizontalContentAlignment" Value="Stretch" />
			<Setter Property="Background" Value="Transparent" />
			<Setter Property="BorderThickness" Value="1" />
			<Setter Property="BorderBrush" Value="Transparent" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="ListViewItem">
						<Grid>
							<Border
                                x:Name="RowRoot"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="10">
								<ContentPresenter
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Content="{TemplateBinding Content}"
                                    ContentTemplate="{TemplateBinding ContentTemplate}" />
							</Border>

							<VisualStateManager.VisualStateGroups>
								<VisualStateGroup x:Name="CommonStates">
									<VisualState x:Name="Normal" />
									<VisualState x:Name="PointerOver">
										<VisualState.Setters>
											<Setter Target="RowRoot.Background" Value="#1AFFFFFF" />
											<Setter Target="RowRoot.BorderBrush" Value="#33FFFFFF" />
										</VisualState.Setters>
									</VisualState>
									<VisualState x:Name="Pressed">
										<VisualState.Setters>
											<Setter Target="RowRoot.Background" Value="#22FFFFFF" />
											<Setter Target="RowRoot.BorderBrush" Value="#55FFFFFF" />
										</VisualState.Setters>
									</VisualState>
									<VisualState x:Name="Disabled">
										<VisualState.Setters>
											<Setter Target="RowRoot.Opacity" Value="0.5" />
										</VisualState.Setters>
									</VisualState>
								</VisualStateGroup>

								<VisualStateGroup x:Name="SelectionStates">
									<VisualState x:Name="Unselected" />
									<VisualState x:Name="Selected">
										<VisualState.Setters>
											<Setter Target="RowRoot.Background" Value="#222222" />
											<Setter Target="RowRoot.BorderBrush" Value="#666666" />
										</VisualState.Setters>
									</VisualState>
									<VisualState x:Name="SelectedPointerOver">
										<VisualState.Setters>
											<Setter Target="RowRoot.Background" Value="#222222" />
											<Setter Target="RowRoot.BorderBrush" Value="#777777" />
										</VisualState.Setters>
									</VisualState>
								</VisualStateGroup>
							</VisualStateManager.VisualStateGroups>
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<MenuFlyout x:Key="PlaylistFlyout" Opening="PlaylistFlyout_Opening">
			<MenuFlyoutItem
		              x:Name="FlyoutOpen"
		              Click="Playlist_Open_Click"
		              Text="Open">
				<MenuFlyoutItem.Icon>
					<SymbolIcon Symbol="OpenFile" />
				</MenuFlyoutItem.Icon>
			</MenuFlyoutItem>

			<MenuFlyoutSeparator />

			<MenuFlyoutItem
		              x:Name="FlyoutChangeCover"
		              Click="Playlist_ChangeCover_Click"
		              Text="Change Cover...">
				<MenuFlyoutItem.Icon>
					<SymbolIcon Symbol="Pictures" />
				</MenuFlyoutItem.Icon>
			</MenuFlyoutItem>

			<MenuFlyoutItem
		              x:Name="FlyoutRename"
		              Click="Playlist_Rename_Click"
		              Text="Rename">
				<MenuFlyoutItem.Icon>
					<SymbolIcon Symbol="Edit" />
				</MenuFlyoutItem.Icon>
			</MenuFlyoutItem>

			<MenuFlyoutSeparator />

			<MenuFlyoutItem
		              x:Name="FlyoutDelete"
		              Click="Playlist_Delete_Click"
		              Text="Delete">
				<MenuFlyoutItem.Icon>
					<SymbolIcon Symbol="Delete" />
				</MenuFlyoutItem.Icon>
			</MenuFlyoutItem>
		</MenuFlyout>
	</Page.Resources>

	<Grid Padding="24">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<!-- Title -->
		<TextBlock Grid.Row="0" Text="Playlists" Style="{StaticResource TitleTextBlockStyle}" Margin="0,0,0,16"/>

		<!-- Command Bar -->
		<CommandBar Grid.Row="1" DefaultLabelPosition="Right" Margin="0,0,0,16">
			<AppBarButton Icon="Add" Label="New Playlist" Click="NewPlaylist_Click"/>
			<AppBarButton Icon="Refresh" Label="Refresh" Click="Refresh_Click"/>
		</CommandBar>

		<!-- Playlists List -->
		<ListView Grid.Row="2"
                  x:Name="PlaylistsList"
                  SelectionMode="Single"
                  ItemClick="PlaylistsList_ItemClick"
                  IsItemClickEnabled="True"
                  RightTapped="PlaylistsList_RightTapped">

			<ListView.ItemContainerStyle>
				<Style BasedOn="{StaticResource PlaylistListViewItemStyle}" TargetType="ListViewItem">
					<Setter Property="ContextFlyout" Value="{StaticResource PlaylistFlyout}" />
				</Style>
			</ListView.ItemContainerStyle>

			<ListView.ItemTemplate>
				<DataTemplate x:DataType="playlists:PlaylistModel">
					<Grid Padding="12" ColumnSpacing="12">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="64"/>
							<ColumnDefinition Width="*"/>
						</Grid.ColumnDefinitions>
	
						<!-- Thumbnail -->
						<Border Grid.Column="0"
			                          Width="64" Height="64"
			                          CornerRadius="4"
			                          Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
							<Image x:Name="CoverImage" Stretch="UniformToFill"/>
						</Border>
	
						<!-- Info -->
						<StackPanel Grid.Column="1" VerticalAlignment="Center">
							<TextBlock Text="{x:Bind Name}" Style="{StaticResource BodyStrongTextBlockStyle}"/>
							<TextBlock Foreground="{ThemeResource TextFillColorSecondaryBrush}">
								<Run Text="{Binding ItemCount, Mode=OneWay}"/>
								<Run Text="videos"/>
							</TextBlock>
						</StackPanel>
					</Grid>
				</DataTemplate>
			</ListView.ItemTemplate>
		</ListView>

		<!-- Empty State -->
		<StackPanel Grid.Row="2" 
                    x:Name="EmptyState"
                    Visibility="Collapsed"
                    HorizontalAlignment="Center" 
                    VerticalAlignment="Center">
			<TextBlock Text="No playlists yet" Style="{StaticResource SubtitleTextBlockStyle}"/>
			<TextBlock Text="Create a playlist to get started" 
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                       Margin="0,8,0,0"/>
		</StackPanel>
	</Grid>
</Page>
