<Page
    x:Class="VideoBeast.Pages.PlayerPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

	<Page.Resources>

		<!-- ========================= -->
		<!-- Chip button (compact)     -->
		<!-- ========================= -->
		<Style x:Key="PlayerChipButtonStyle" TargetType="Button">
			<Setter Property="MinWidth" Value="32" />
			<Setter Property="MinHeight" Value="32" />
			<Setter Property="Padding" Value="6" />
			<Setter Property="CornerRadius" Value="10" />
			<Setter Property="Background" Value="#14FFFFFF" />
			<Setter Property="BorderThickness" Value="0" />
			<Setter Property="HorizontalAlignment" Value="Center" />
			<Setter Property="VerticalAlignment" Value="Center" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border
                            x:Name="Root"
                            Background="{TemplateBinding Background}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            BorderThickness="{TemplateBinding BorderThickness}">

							<VisualStateManager.VisualStateGroups>
								<VisualStateGroup x:Name="CommonStates">
									<VisualState x:Name="Normal" />
									<VisualState x:Name="PointerOver">
										<VisualState.Setters>
											<Setter Target="Root.Background" Value="#24FFFFFF" />
										</VisualState.Setters>
									</VisualState>
									<VisualState x:Name="Pressed">
										<VisualState.Setters>
											<Setter Target="Root.Background" Value="#2EFFFFFF" />
										</VisualState.Setters>
									</VisualState>
									<VisualState x:Name="Disabled">
										<VisualState.Setters>
											<Setter Target="Root.Opacity" Value="0.45" />
										</VisualState.Setters>
									</VisualState>
								</VisualStateGroup>
							</VisualStateManager.VisualStateGroups>

							<ContentPresenter
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Content="{TemplateBinding Content}" />
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- ========================= -->
		<!-- Chip toggle (compact)     -->
		<!-- ========================= -->
		<Style x:Key="PlayerChipToggleStyle" TargetType="ToggleButton">
			<Setter Property="MinWidth" Value="32" />
			<Setter Property="MinHeight" Value="32" />
			<Setter Property="Padding" Value="6" />
			<Setter Property="CornerRadius" Value="10" />
			<Setter Property="Background" Value="#14FFFFFF" />
			<Setter Property="BorderThickness" Value="0" />
			<Setter Property="HorizontalAlignment" Value="Center" />
			<Setter Property="VerticalAlignment" Value="Center" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="ToggleButton">
						<Border
                            x:Name="Root"
                            Background="{TemplateBinding Background}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            BorderThickness="{TemplateBinding BorderThickness}">

							<VisualStateManager.VisualStateGroups>
								<VisualStateGroup x:Name="CommonStates">
									<VisualState x:Name="Normal" />
									<VisualState x:Name="PointerOver">
										<VisualState.Setters>
											<Setter Target="Root.Background" Value="#24FFFFFF" />
										</VisualState.Setters>
									</VisualState>
									<VisualState x:Name="Pressed">
										<VisualState.Setters>
											<Setter Target="Root.Background" Value="#2EFFFFFF" />
										</VisualState.Setters>
									</VisualState>
									<VisualState x:Name="Disabled">
										<VisualState.Setters>
											<Setter Target="Root.Opacity" Value="0.45" />
										</VisualState.Setters>
									</VisualState>
								</VisualStateGroup>

								<VisualStateGroup x:Name="CheckStates">
									<VisualState x:Name="Unchecked" />
									<VisualState x:Name="Checked">
										<VisualState.Setters>
											<Setter Target="Root.Background" Value="#3AFFFFFF" />
										</VisualState.Setters>
									</VisualState>
									<VisualState x:Name="Indeterminate" />
								</VisualStateGroup>
							</VisualStateManager.VisualStateGroups>

							<ContentPresenter
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Content="{TemplateBinding Content}" />
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- ========================= -->
		<!-- Small ComboBox            -->
		<!-- ========================= -->
		<Style x:Key="PlayerSmallComboStyle" TargetType="ComboBox">
			<Setter Property="MinHeight" Value="32" />
			<Setter Property="FontSize" Value="12" />
			<Setter Property="Padding" Value="10,6" />
		</Style>

		<!-- ========================= -->
		<!-- Thin Slider (smaller thumb + thinner track) -->
		<!-- ========================= -->
		<Style x:Key="PlayerThinSliderStyle" TargetType="Slider">
			<Setter Property="Background" Value="#2AFFFFFF" />
			<Setter Property="Foreground" Value="#DFFFFFFF" />
			<Setter Property="MinHeight" Value="18" />
			<Setter Property="Template">
				<Setter.Value>
					<!-- Adapted from a complete UWP slider template approach (kept required template parts) -->
					<ControlTemplate TargetType="Slider">
						<Grid Margin="{TemplateBinding Padding}">

							<Grid.Resources>
								<Style x:Key="PlayerSliderThumbStyle" TargetType="Thumb">
									<Setter Property="Background" Value="#F2FFFFFF" />
									<Setter Property="BorderThickness" Value="0" />
									<Setter Property="Template">
										<Setter.Value>
											<ControlTemplate TargetType="Thumb">
												<Border
                                                    Background="{TemplateBinding Background}"
                                                    CornerRadius="999"
                                                    Width="{TemplateBinding Width}"
                                                    Height="{TemplateBinding Height}" />
											</ControlTemplate>
										</Setter.Value>
									</Setter>
								</Style>
							</Grid.Resources>

							<Grid
                                x:Name="SliderContainer"
                                Background="Transparent"
                                Control.IsTemplateFocusTarget="True">

								<!-- Horizontal -->
								<Grid x:Name="HorizontalTemplate" MinHeight="18">
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="Auto" />
										<ColumnDefinition Width="Auto" />
										<ColumnDefinition Width="*" />
									</Grid.ColumnDefinitions>

									<!-- collapse top/bottom spacing for a tighter “Netflix clean” look -->
									<Grid.RowDefinitions>
										<RowDefinition Height="0" />
										<RowDefinition Height="Auto" />
										<RowDefinition Height="0" />
									</Grid.RowDefinitions>

									<Rectangle
                                        x:Name="HorizontalTrackRect"
                                        Grid.Row="1"
                                        Grid.ColumnSpan="3"
                                        Height="3"
                                        RadiusX="2"
                                        RadiusY="2"
                                        Fill="{TemplateBinding Background}"
                                        VerticalAlignment="Center" />

									<Rectangle
                                        x:Name="HorizontalDecreaseRect"
                                        Grid.Row="1"
                                        Height="3"
                                        RadiusX="2"
                                        RadiusY="2"
                                        Fill="{TemplateBinding Foreground}"
                                        VerticalAlignment="Center" />

									<Thumb
                                        x:Name="HorizontalThumb"
                                        Grid.Row="0"
                                        Grid.RowSpan="3"
                                        Grid.Column="1"
                                        Width="12"
                                        Height="12"
                                        AutomationProperties.AccessibilityView="Raw"
                                        DataContext="{TemplateBinding Value}"
                                        Style="{StaticResource PlayerSliderThumbStyle}" />
								</Grid>

								<!-- Vertical (not used, but keep template parts) -->
								<Grid x:Name="VerticalTemplate" Visibility="Collapsed">
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="0" />
										<ColumnDefinition Width="Auto" />
										<ColumnDefinition Width="0" />
									</Grid.ColumnDefinitions>
									<Grid.RowDefinitions>
										<RowDefinition Height="*" />
										<RowDefinition Height="Auto" />
										<RowDefinition Height="Auto" />
									</Grid.RowDefinitions>

									<Rectangle
                                        x:Name="VerticalTrackRect"
                                        Grid.RowSpan="3"
                                        Grid.Column="1"
                                        Width="3"
                                        RadiusX="2"
                                        RadiusY="2"
                                        Fill="{TemplateBinding Background}" />

									<Rectangle
                                        x:Name="VerticalDecreaseRect"
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        Width="3"
                                        RadiusX="2"
                                        RadiusY="2"
                                        Fill="{TemplateBinding Foreground}" />

									<Thumb
                                        x:Name="VerticalThumb"
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        Width="12"
                                        Height="12"
                                        AutomationProperties.AccessibilityView="Raw"
                                        DataContext="{TemplateBinding Value}"
                                        Style="{StaticResource PlayerSliderThumbStyle}" />
								</Grid>

								<VisualStateManager.VisualStateGroups>
									<VisualStateGroup x:Name="CommonStates">
										<VisualState x:Name="Normal" />
										<VisualState x:Name="PointerOver">
											<VisualState.Setters>
												<Setter Target="SliderContainer.Opacity" Value="1" />
											</VisualState.Setters>
										</VisualState>
										<VisualState x:Name="Pressed">
											<VisualState.Setters>
												<Setter Target="SliderContainer.Opacity" Value="1" />
											</VisualState.Setters>
										</VisualState>
										<VisualState x:Name="Disabled">
											<VisualState.Setters>
												<Setter Target="SliderContainer.Opacity" Value="0.45" />
											</VisualState.Setters>
										</VisualState>
									</VisualStateGroup>
								</VisualStateManager.VisualStateGroups>

							</Grid>
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

	</Page.Resources>

	<Grid
        x:Name="LayoutRoot"
        Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
        PointerMoved="PlayerArea_PointerMoved"
        PointerPressed="PlayerArea_PointerPressed"
        Tapped="PlayerArea_Tapped">

		<Border
            x:Name="CardShell"
            Margin="5"
            Padding="0"
            Background="Transparent"
            BorderBrush="Transparent"
            BorderThickness="0"
            CornerRadius="0">

			<Grid RowSpacing="10">
				<Grid.RowDefinitions>
					<RowDefinition Height="*" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>

				<Grid Grid.Row="0">

					<Border
                        x:Name="PlayerHost"
                        Background="#FF000000"
                        BorderThickness="0"
                        CornerRadius="16">

						<Grid
                            x:Name="PlayerArea"
                            Margin="0"
                            Padding="0"
                            PointerMoved="PlayerArea_PointerMoved"
                            PointerPressed="PlayerArea_PointerPressed"
                            Tapped="PlayerArea_Tapped">

							<MediaPlayerElement
                                x:Name="Player"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                AreTransportControlsEnabled="False"
                                AutoPlay="False"
                                Background="Black"
                                Stretch="UniformToFill"
                                Tapped="Player_Tapped" />

							<!-- Control Bar -->
							<Border
                                x:Name="ControlBar"
                                Margin="12"
                                Padding="10"
                                VerticalAlignment="Bottom"
                                Background="#B0121212"
                                BorderThickness="0"
                                CornerRadius="12"
                                Opacity="1"
                                PointerEntered="ControlBar_PointerEntered"
                                PointerExited="ControlBar_PointerExited">

								<StackPanel Spacing="8">

									<!-- Timeline row -->
									<Grid ColumnSpacing="10">
										<Grid.ColumnDefinitions>
											<ColumnDefinition Width="Auto" />
											<ColumnDefinition Width="*" />
											<ColumnDefinition Width="Auto" />
										</Grid.ColumnDefinitions>

										<TextBlock
                                            x:Name="PositionText"
                                            Grid.Column="0"
                                            FontSize="12"
                                            Foreground="White"
                                            Text="0:00" />

										<Slider
                                            x:Name="SeekSlider"
                                            Grid.Column="1"
                                            Style="{StaticResource PlayerThinSliderStyle}"
                                            Maximum="1"
                                            Minimum="0"
                                            SnapsTo="StepValues"
                                            StepFrequency="0.1"
                                            ValueChanged="SeekSlider_ValueChanged"
                                            Value="0" />

										<TextBlock
                                            x:Name="DurationText"
                                            Grid.Column="2"
                                            FontSize="12"
                                            Foreground="White"
                                            Text="0:00" />
									</Grid>

									<!-- Controls row -->
									<Grid ColumnSpacing="10">
										<Grid.ColumnDefinitions>
											<ColumnDefinition Width="Auto" />
											<ColumnDefinition Width="Auto" />
											<ColumnDefinition Width="Auto" />
											<ColumnDefinition Width="Auto" />
											<ColumnDefinition Width="Auto" />
											<ColumnDefinition Width="*" />
											<ColumnDefinition Width="Auto" />
											<ColumnDefinition Width="Auto" />
										</Grid.ColumnDefinitions>

										<!-- Play/Pause -->
										<Button
                                            x:Name="PlayPauseButton"
                                            Grid.Column="0"
                                            Style="{StaticResource PlayerChipButtonStyle}"
                                            Click="PlayPause_Click">
											<Grid>
												<SymbolIcon x:Name="PlayPauseIcon" Symbol="Play" Foreground="White" Width="18" Height="18" />
												<!-- Keep this for your existing code-behind logic; hidden so UI stays icon-only -->
												<TextBlock x:Name="PlayPauseText" Visibility="Collapsed" />
											</Grid>
										</Button>

										<!-- Stop -->
										<Button
                                            Grid.Column="1"
                                            Style="{StaticResource PlayerChipButtonStyle}"
                                            Click="Stop_Click"
                                            ToolTipService.ToolTip="Stop">
											<SymbolIcon Symbol="Stop" Foreground="White" Width="18" Height="18" />
										</Button>

										<!-- Loop -->
										<ToggleButton
                                            x:Name="LoopToggle"
                                            Grid.Column="2"
                                            Style="{StaticResource PlayerChipToggleStyle}"
                                            Click="LoopToggle_Click">
											<SymbolIcon Symbol="RepeatAll" Foreground="White" Width="18" Height="18" />
										</ToggleButton>

										<!-- Mute -->
										<ToggleButton
                                            x:Name="MuteToggle"
                                            Grid.Column="3"
                                            Style="{StaticResource PlayerChipToggleStyle}"
                                            Click="MuteToggle_Click"
                                            ToolTipService.ToolTip="Mute">
											<SymbolIcon x:Name="MuteIcon" Symbol="Volume" Foreground="White" Width="18" Height="18" />
										</ToggleButton>

										<!-- Volume -->
										<StackPanel
                                            Grid.Column="4"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal"
                                            Spacing="8">
											<TextBlock FontSize="12" Foreground="White" Text="Vol" />
											<Slider
                                                x:Name="VolumeSlider"
                                                Width="110"
                                                Style="{StaticResource PlayerThinSliderStyle}"
                                                LargeChange="10"
                                                Maximum="100"
                                                Minimum="0"
                                                SmallChange="1"
                                                SnapsTo="StepValues"
                                                StepFrequency="1"
                                                ValueChanged="VolumeSlider_ValueChanged" />
										</StackPanel>

										<Grid Grid.Column="5" />

										<!-- Rate -->
										<ComboBox
                                            x:Name="RateCombo"
                                            Grid.Column="6"
                                            Width="92"
                                            Style="{StaticResource PlayerSmallComboStyle}"
                                            SelectionChanged="RateCombo_SelectionChanged">
											<ComboBoxItem Content="0.5x" Tag="0.5" />
											<ComboBoxItem Content="1.0x" IsSelected="True" Tag="1.0" />
											<ComboBoxItem Content="1.25x" Tag="1.25" />
											<ComboBoxItem Content="1.5x" Tag="1.5" />
											<ComboBoxItem Content="2.0x" Tag="2.0" />
										</ComboBox>

										<!-- Full screen -->
										<ToggleButton
                                            x:Name="FullWindowToggle"
                                            Grid.Column="7"
                                            Style="{StaticResource PlayerChipToggleStyle}"
                                            Click="FullWindowToggle_Click">
											<SymbolIcon Symbol="FullScreen" Foreground="White" Width="18" Height="18" />
										</ToggleButton>
									</Grid>

								</StackPanel>
							</Border>
						</Grid>
					</Border>

					<Border
                        x:Name="EmptyState"
                        Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
                        BorderThickness="0"
                        CornerRadius="16"
                        Opacity="0.98"
                        Visibility="Collapsed">
						<StackPanel
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="10">
							<TextBlock
                                HorizontalAlignment="Center"
                                FontSize="22"
                                FontWeight="SemiBold"
                                Text="Pick a folder, then import MP4s" />
							<TextBlock
                                HorizontalAlignment="Center"
                                Foreground="{StaticResource TextFaint}"
                                Text="Select a folder in the left pane, then open Playlist from the menu to browse videos." />
						</StackPanel>
					</Border>
				</Grid>
			</Grid>
		</Border>

		<VisualStateManager.VisualStateGroups>
			<VisualStateGroup x:Name="ControlsStates">
				<VisualState x:Name="ControlsVisible">
					<Storyboard>
						<DoubleAnimation
                            Storyboard.TargetName="ControlBar"
                            Storyboard.TargetProperty="Opacity"
                            To="1"
                            Duration="0:0:0.15" />
					</Storyboard>
				</VisualState>

				<VisualState x:Name="ControlsHidden">
					<Storyboard>
						<DoubleAnimation
                            Storyboard.TargetName="ControlBar"
                            Storyboard.TargetProperty="Opacity"
                            To="0"
                            Duration="0:0:0.20" />
					</Storyboard>
				</VisualState>
			</VisualStateGroup>

			<VisualStateGroup x:Name="PlayerWindowStates">
				<VisualState x:Name="PlayerNormal" />

				<VisualState x:Name="PlayerFullWindow">
					<VisualState.Setters>
						<Setter Target="CardShell.Margin" Value="0" />
						<Setter Target="CardShell.Padding" Value="0" />
						<Setter Target="CardShell.CornerRadius" Value="0" />
						<Setter Target="CardShell.BorderThickness" Value="0" />
						<Setter Target="PlayerHost.CornerRadius" Value="0" />
						<Setter Target="PlayerHost.BorderThickness" Value="0" />
						<Setter Target="ControlBar.Margin" Value="16" />
					</VisualState.Setters>
				</VisualState>
			</VisualStateGroup>
		</VisualStateManager.VisualStateGroups>

	</Grid>
</Page>