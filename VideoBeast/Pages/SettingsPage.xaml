<Page
    x:Class="VideoBeast.Pages.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

	<ScrollViewer>
		<StackPanel Margin="12" Spacing="12">

			<TextBlock
                FontSize="24"
                FontWeight="SemiBold"
                Text="Settings" />

			<Border
                Padding="12"
                Background="{ThemeResource VB.Card}"
                BorderBrush="{ThemeResource VB.Stroke}"
                BorderThickness="1"
                CornerRadius="18">

				<StackPanel Spacing="10">
					<TextBlock
                        FontSize="16"
                        FontWeight="SemiBold"
                        Text="Playback scaling" />

					<TextBlock
                        Foreground="{ThemeResource VB.TextFaint}"
                        Text="Choose how the video fits inside the player." />

					<RadioButton
                        x:Name="RbFit"
                        Checked="Scaling_Checked"
                        Content="Fit (keep aspect ratio, black bars)" />

					<RadioButton
                        x:Name="RbFill"
                        Checked="Scaling_Checked"
                        Content="Fill (crop to fill, no bars)" />

					<RadioButton
                        x:Name="RbStretch"
                        Checked="Scaling_Checked"
                        Content="Stretch (fill, may distort)" />
				</StackPanel>
			</Border>

			<Border
                Padding="12"
                Background="{ThemeResource VB.Card}"
                BorderBrush="{ThemeResource VB.Stroke}"
                BorderThickness="1"
                CornerRadius="18">

				<StackPanel Spacing="10">
					<TextBlock
                        FontSize="16"
                        FontWeight="SemiBold"
                        Text="Local AI (Ollama)" />

					<TextBlock
					                    Foreground="{ThemeResource VB.TextFaint}"
					                    TextWrapping="Wrap"
					                    Text="Enable AI-powered commands in the search box. Type '>' followed by a command (e.g., '>play nature video'). Requires Ollama running at http://localhost:11434" />
	
						<!-- Live Status Indicator -->
						<Grid ColumnSpacing="12">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto" />
								<ColumnDefinition Width="Auto" />
								<ColumnDefinition Width="*" />
							</Grid.ColumnDefinitions>
	
							<StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">
								<Ellipse
									x:Name="OllamaStatusIndicator"
									Width="10"
									Height="10"
									Fill="#FFF44336"
									VerticalAlignment="Center" />
								<TextBlock Text="Status:" Foreground="{ThemeResource VB.TextFaint}" VerticalAlignment="Center" />
								<TextBlock
									x:Name="OllamaConnectionStatus"
									Text="Disconnected"
									FontWeight="SemiBold"
									VerticalAlignment="Center" />
							</StackPanel>
	
							<StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">
								<TextBlock Text="Endpoint:" Foreground="{ThemeResource VB.TextFaint}" VerticalAlignment="Center" />
								<TextBlock
									x:Name="OllamaEndpointText"
									Text="—"
									VerticalAlignment="Center" />
							</StackPanel>
	
							<StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="6" VerticalAlignment="Center" HorizontalAlignment="Left">
								<TextBlock Text="Latency:" Foreground="{ThemeResource VB.TextFaint}" VerticalAlignment="Center" />
								<TextBlock
									x:Name="OllamaLatencyText"
									Text="—"
									VerticalAlignment="Center" />
							</StackPanel>
						</Grid>
	
						<ToggleSwitch
                        x:Name="OllamaEnabledToggle"
                        Header="Enable Local AI"
                        Toggled="OllamaEnabled_Toggled" />

					<TextBox
                        x:Name="OllamaBaseUrlBox"
                        Header="Ollama Base URL"
                        PlaceholderText="http://localhost:11434"
                        TextChanged="OllamaBaseUrl_Changed" />

					<ComboBox
                        x:Name="OllamaModelCombo"
                        Header="AI Model"
                        PlaceholderText="Select a model"
                        MinWidth="300"
                        SelectionChanged="OllamaModel_SelectionChanged" />

					<StackPanel Orientation="Horizontal" Spacing="8">
							<Button
								x:Name="RefreshModelsButton"
								Content="Refresh Models"
								Click="RefreshModels_Click" />
							<Button
								x:Name="StartOllamaButton"
								Content="Start Ollama"
								Click="StartOllama_Click" />
							<Button
								x:Name="CancelOllamaButton"
								Content="Cancel"
								Visibility="Collapsed"
								Click="CancelOllama_Click" />
							<Button
								x:Name="OpenOllamaInBrowserButton"
								Content="Open in Browser"
								Click="OpenOllamaInBrowser_Click" />
							<Button
								x:Name="CopyOllamaEndpointButton"
								Click="CopyOllamaEndpoint_Click">
								<StackPanel Orientation="Horizontal" Spacing="4">
									<FontIcon FontSize="14" Glyph="&#xE8C8;" />
									<TextBlock Text="Copy Endpoint" />
								</StackPanel>
							</Button>
						</StackPanel>

					<TextBlock
					                   x:Name="OllamaStatusText"
					                   Foreground="{ThemeResource VB.TextFaint}"
					                   TextWrapping="Wrap" />
				</StackPanel>
			</Border>

			<StackPanel
                HorizontalAlignment="Right"
                Orientation="Horizontal"
                Spacing="8">
				<Button Click="Reset_Click" Content="Reset" />
				<Button
                    Click="Save_Click"
                    Content="Save"
                    Style="{StaticResource VB.AccentButtonStyle}" />
			</StackPanel>

		</StackPanel>
	</ScrollViewer>
</Page>
